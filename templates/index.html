<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HistoReactor - Arc Reactor Powered Image Enhancement</title>
    <link rel="icon" type="image/png" sizes="16x16,32x32,48x48" href="{{ url_for('static', filename='arc_reactor.png') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="light-theme">
    <button id="themeToggle" class="theme-toggle">Dark</button>

    <div class="container">
        <header>
            <h1>HistoReactor</h1>
            <p class="subtitle">Powered by Arc Reactor Technology &ndash; Enhance Your Images with Futuristic Precision</p>
        </header>

        <div class="main-card">
            <div class="upload-section">
                <div id="uploadArea" class="upload-area">
                    <i class="bi bi-cloud-upload upload-icon"></i>
                    <div class="upload-text">Drop your images here or click to browse</div>
                    <div class="upload-subtext">Supports multiple PNG, JPG, JPEG, BMP, TIFF (Max 16MB each)</div>
                </div>
                <input type="file" id="fileInput" multiple accept="image/*">
            </div>

            <div id="previewSection" class="preview-section">
                <div class="preview-container">
                    <div class="nav-row">
                        <button id="prevPreview" class="nav-btn"><i class="bi bi-chevron-left"></i></button>
                        <img id="previewImage" class="preview-image" alt="Preview">
                        <button id="nextPreview" class="nav-btn"><i class="bi bi-chevron-right"></i></button>
                    </div>
                    <p id="previewCounter" class="counter-text">Image 1 of 1</p>
                </div>

                <div class="method-buttons">
                    <button class="method-btn dhe-card" onclick="processImage('DHE')">
                        <div class="card-header">
                            <i class="bi bi-lightning-charge-fill"></i>
                            <span class="header-text">DHE</span>
                        </div>
                        <div class="btn-content">
                            <h3>Dynamic Histogram Equalization</h3>
                            <p>The Mark I of contrast enhancement — raw, powerful, and built for instant clarity. DHE channels direct histogram energy to dynamically balance light and shadow, forging images that radiate controlled intensity.</p>
                            <div class="features">
                                <span class="feature">Fast</span>
                                <span class="feature">Balanced</span>
                                <span class="feature">Simple</span>
                            </div>
                        </div>
                    </button>
                    <button class="method-btn rswhe-card" onclick="processImage('RSWHE')">
                        <div class="card-header">
                            <i class="bi bi-battery-charging"></i>
                            <span class="header-text">RSWHE</span>
                        </div>
                        <div class="btn-content">
                            <h3>Recursive Seperated and Weighted Histogram Equalization</h3>
                            <p>The adaptive armor of image enhancement. RSWHE divides and conquers — stratifying brightness zones to stabilize contrast under any lighting condition. Like a reactive suit, it adjusts on the fly for flawless tonal defense.</p>
                            <div class="features">
                                <span class="feature">Powerful</span>
                                <span class="feature">Adaptive</span>
                                <span class="feature">Detail-Preserving</span>
                            </div>
                        </div>
                    </button>
                    <button class="method-btn aspohe-card" onclick="processImage('ASPOHE')">
                        <div class="card-header">
                            <i class="bi bi-gear-fill"></i>
                            <span class="header-text">ASPOHE</span>
                        </div>
                        <div class="btn-content">
                            <h3>Adaptive Stratified Parametric Oriented Histogram Equalization</h3>
                            <p>The Arc Reactor Core of Historeactor — intelligent, adaptive, and optimized. ASPOHE analyzes visual complexity to self-tune parameters, ensuring every pixel is enhanced with Stark-level precision and balance.</p>
                            <div class="features">
                                <span class="feature">Advanced</span>
                                <span class="feature">High-Contrast</span>
                                <span class="feature">Noise-Reduced</span>
                            </div>
                        </div>
                    </button>
                </div>
            </div>

            <div id="loader" class="loader">
                <video class="arc-video" autoplay muted loop playsinline>
                    <source src="{{ url_for('static', filename='arc_reactor_video.mp4') }}" type="video/mp4">
                    <div class="arc-reactor-fallback">
                        <div class="core"></div>
                        <div class="ring ring-1"></div>
                        <div class="ring ring-2"></div>
                        <div class="ring ring-3"></div>
                        <div class="glow"></div>
                    </div>
                </video>
                <div class="loader-text">Activating Arc Reactor... Processing your images</div>
            </div>

            <div id="resultsSection" class="results-section">
                <div class="enhanced-thumbnails-section">
                    <h3 class="section-title"><i class="bi bi-images"></i> Enhanced Images</h3>
                    <div class="nav-row">
                        <button id="prevResult" class="nav-btn"><i class="bi bi-chevron-left"></i></button>
                        <span id="resultCounter" class="counter-text">Image 1 of 1</span>
                        <button id="nextResult" class="nav-btn"><i class="bi bi-chevron-right"></i></button>
                    </div>
                    <div class="thumbnails-container" id="thumbnailsContainer"></div>
                </div>

                <div class="comparison-container">
                    <h3 class="section-title"><i class="bi bi-layout-split"></i> Compare Original vs Enhanced</h3>
                    <div class="image-comparison">
                        <div class="comparison-images">
                            <img id="originalImg" class="img-original" src="" alt="Original">
                            <img id="enhancedImg" class="img-enhanced" src="" alt="Enhanced">
                        </div>
                    </div>
                    <div class="slider-container">
                        <input type="range" id="comparisonSlider" class="comparison-slider" min="0" max="100" value="50">
                        <div class="slider-labels">
                            <span>Original</span>
                            <span>Enhanced</span>
                        </div>
                    </div>
                </div>

                <div class="histogram-container">
                    <h3 class="section-title"><i class="bi bi-bar-chart"></i> Histogram Comparison</h3>
                    <canvas id="histChart" width="400" height="200"></canvas>
                </div>

                <div class="download-section">
                    <button id="downloadBtn" class="download-btn" onclick="downloadImage()">
                        <i class="bi bi-download"></i> Download Current Enhanced Image
                    </button>
                    <button class="reset-btn" onclick="resetApp()">
                        <i class="bi bi-arrow-clockwise"></i> Process Another Set
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="alertContainer" class="alert-container"></div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>